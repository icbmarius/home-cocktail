<%- include("partials/head", { title: "Cocktail Menu" }) %>

<section class="page-head menu-head">
  <div>
    <p class="eyebrow">House Selection</p>
    <h1>Cocktail Menu</h1>
    <p>Vezi cocktail-urile, apoi completeaza formularul de comanda din partea de jos.</p>
  </div>
</section>

<section class="grid">
  <% if (!cocktails.length) { %>
    <div class="card">
      <h3>Meniul este gol</h3>
      <p>Gazda va adauga in curand cocktail-urile disponibile.</p>
    </div>
  <% } %>

  <% cocktails.forEach((item) => { %>
    <article class="card cocktail-card">
      <% if (item.image_path) { %>
        <img class="cocktail-image" src="<%= item.image_path %>" alt="<%= item.name %>" />
      <% } %>
      <h3><%= item.name %></h3>
      <p class="ingredients"><%= item.ingredients %></p>
    </article>
  <% }) %>
</section>

<section class="card order-launch">
  <h2>Comanda</h2>
  <p class="muted">Cand esti gata, apasa butonul de mai jos.</p>
  <button class="btn order-main-btn" id="openOrderBtn" type="button" <%= cocktails.length ? "" : "disabled" %>>
    Order
  </button>
</section>

<section class="card order-sheet" id="orderSheet" <%= orderError || orderSuccess ? "" : "hidden" %>>
  <h2>Order Form</h2>
  <form class="form" method="POST" action="/order">
    <label>
      Numele tau *
      <input id="customerNameField" type="text" name="customer_name" required placeholder="Ex: Alex" />
    </label>

    <label>
      Bautura *
      <select name="cocktail_id" required>
        <option value="">Alege un cocktail</option>
        <% cocktails.forEach((item) => { %>
          <option value="<%= item.id %>" <%= selectedId === item.id ? "selected" : "" %>><%= item.name %></option>
        <% }) %>
      </select>
    </label>

    <label>
      Detalii
      <textarea name="note" rows="3" placeholder="Ex: fara gheata, extra lime"></textarea>
    </label>

    <button class="btn" type="submit">Trimite comanda</button>
  </form>

  <% if (orderError) { %>
    <p class="alert"><%= orderError %></p>
  <% } %>

  <% if (orderSuccess) { %>
    <p class="success"><%= orderSuccess %></p>
  <% } %>

  <% if (!whatsappConfigured) { %>
    <p class="muted">WhatsApp nu este configurat inca. Seteaza Twilio sau `WHATSAPP_NUMBER`.</p>
  <% } %>
</section>

<script>
  (() => {
    const openOrderBtn = document.getElementById("openOrderBtn");
    const orderSheet = document.getElementById("orderSheet");
    const customerNameField = document.getElementById("customerNameField");
    if (!openOrderBtn || !orderSheet) return;

    openOrderBtn.addEventListener("click", () => {
      orderSheet.hidden = false;
      orderSheet.scrollIntoView({ behavior: "smooth", block: "start" });
      if (customerNameField) customerNameField.focus();
    });
  })();
</script>

<%- include("partials/foot") %>
